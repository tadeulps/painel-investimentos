<section class="dashboard-page">
  <!-- Loading State -->
  <div *ngIf="isLoading" class="loading-container">
    <mat-spinner diameter="50"></mat-spinner>
    <p>Carregando seu dashboard...</p>
  </div>

  <!-- Dashboard Content -->
  <div *ngIf="!isLoading && userProfile" class="dashboard-content">
    
    <!-- 1Ô∏è‚É£ Resumo do Investidor -->
    <mat-card class="investor-summary">
      <mat-card-content>
        <div class="welcome-section">
          <h1 class="greeting">{{ getGreeting() }}, {{ userProfile.nome }}!</h1>
          <p class="subtitle">Simule e invista com seguran√ßa, tudo num s√≥ lugar.</p>
        </div>

        <mat-chip-set class="risk-profile-badge" [class]="'profile-' + getRiskProfileClass()">
          <mat-chip>
            <div class="card-icon" [class]="'icon-' + getRiskProfileClass()">
              <mat-icon>{{ getRiskProfileIcon() }}</mat-icon>
            </div>
            <div class="profile-info">
              <span class="profile-label">Perfil de Risco</span>
              <span class="profile-name">{{ userProfile.perfilRisco.name }}</span>
            </div>
          </mat-chip>
        </mat-chip-set>
      </mat-card-content>
    </mat-card>

    <!-- üìä Indicadores R√°pidos -->
    <div class="quick-indicators">
      <mat-card class="indicator-card investments">
        <mat-card-content>
          <div class="card-header">
            <div class="card-icon">
              <mat-icon>account_balance_wallet</mat-icon>
            </div>
            <span class="card-label">Valor Total Investido</span>
          </div>
          <span class="card-value">{{ summary.valorTotalInvestido | currency:'BRL' }}</span>
        </mat-card-content>
      </mat-card>

      <mat-card class="indicator-card return">
        <mat-card-content>
          <div class="card-header">
            <div class="card-icon">
              <mat-icon>trending_up</mat-icon>
            </div>
            <span class="card-label">Rentabilidade Acumulada</span>
          </div>
          <div class="card-values">
            <span class="card-value" [class.positive]="summary.rentabilidadeAcumulada > 0" [class.negative]="summary.rentabilidadeAcumulada < 0">
              {{ summary.rentabilidadeAcumulada | currency:'BRL' }}
            </span>
            <span class="card-percentage" *ngIf="summary.valorTotalInvestido > 0">
              {{ (summary.rentabilidadeAcumulada / summary.valorTotalInvestido * 100) | number:'1.2-2' }}% a.a.
            </span>
          </div>
        </mat-card-content>
      </mat-card>

      <mat-card class="indicator-card total">
        <mat-card-content>
          <div class="card-header">
            <div class="card-icon">
              <mat-icon>diamond</mat-icon>
            </div>
            <span class="card-label">Valor Atual Total</span>
          </div>
          <span class="card-value">{{ summary.valorAtualTotal | currency:'BRL' }}</span>
        </mat-card-content>
      </mat-card>

      <mat-card class="indicator-card count">
        <mat-card-content>
          <div class="card-header">
            <div class="card-icon">
              <mat-icon>bar_chart</mat-icon>
            </div>
            <span class="card-label">Investimentos Ativos</span>
          </div>
          <span class="card-value">{{ summary.numeroInvestimentos }}</span>
        </mat-card-content>
      </mat-card>
    </div>

    <!-- üìà Evolu√ß√£o dos Investimentos -->
    <app-investment-evolution-chart 
      *ngIf="investments.length > 0" 
      [investments]="investments">
    </app-investment-evolution-chart>

    <!-- üìä Distribui√ß√£o por Tipo de Produto -->
    <app-product-distribution-chart 
      *ngIf="investments.length > 0" 
      [investments]="investments">
    </app-product-distribution-chart>

    <!-- üìä Hist√≥rico do Perfil de Risco -->
    <app-risk-history-chart 
      *ngIf="investments.length > 0" 
      [investments]="investments">
    </app-risk-history-chart>

    <!-- üíº Lista de Investimentos -->
    <app-investments-list 
      *ngIf="investments.length > 0" 
      [investments]="investments">
    </app-investments-list>

    <!-- Empty State -->
    <mat-card *ngIf="investments.length === 0" class="empty-state">
      <mat-card-content>
        <div class="empty-icon">
          <mat-icon>work_outline</mat-icon>
        </div>
        <h2>Voc√™ ainda n√£o possui investimentos</h2>
        <p>Comece agora explorando nossos produtos e simulando investimentos!</p>
        <div class="empty-actions">
          <a routerLink="/produtos" mat-raised-button color="primary" class="btn-primary">Ver Produtos</a>
          <a routerLink="/simulacao" mat-stroked-button color="primary" class="btn-secondary">Simular Investimento</a>
        </div>
      </mat-card-content>
    </mat-card>

  </div>
</section>
