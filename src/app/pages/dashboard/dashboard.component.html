<section class="dashboard-page" role="main" aria-label="Dashboard de Investimentos">
  <!-- Loading State -->
  <div *ngIf="isLoading" class="loading-container" role="status" aria-live="polite">
    <mat-spinner diameter="50" aria-label="Carregando"></mat-spinner>
    <p>Carregando seu dashboard...</p>
  </div>

  <!-- Dashboard Content -->
  <div *ngIf="!isLoading && userProfile" class="dashboard-content">
    
    <!-- Resumo do Investidor -->
    <mat-card class="investor-summary" role="region" aria-labelledby="welcome-heading">
      <mat-card-content>
        <div class="welcome-section">
          <h1 id="welcome-heading" class="greeting">{{ getGreeting() }}, {{ userProfile.nome }}!</h1>
          <p class="subtitle">Simule e invista com segurança, tudo num só lugar.</p>
        </div>

        <mat-chip-set class="risk-profile-badge" [class]="'profile-' + getRiskProfileClass()" role="status">
          <mat-chip>
            <div class="card-icon" [class]="'icon-' + getRiskProfileClass()" aria-hidden="true">
              <mat-icon>{{ getRiskProfileIcon() }}</mat-icon>
            </div>
            <div class="profile-info">
              <span class="profile-label">Perfil de Risco</span>
              <span class="profile-name">{{ userProfile.perfilRisco.name }}</span>
            </div>
          </mat-chip>
        </mat-chip-set>
      </mat-card-content>
    </mat-card>

    <!-- Indicadores Rápidos -->
    <section class="quick-indicators" role="region" aria-labelledby="indicators-heading">
      <h2 id="indicators-heading" class="sr-only">Indicadores Financeiros</h2>
      
      <mat-card class="indicator-card investments">
        <mat-card-content>
          <div class="card-header">
            <div class="card-icon" aria-hidden="true">
              <mat-icon>account_balance_wallet</mat-icon>
            </div>
            <h3 class="card-label">Valor Total Investido</h3>
          </div>
          <p class="card-value">{{ summary.valorTotalInvestido | currency:'BRL' }}</p>
        </mat-card-content>
      </mat-card>

      <mat-card class="indicator-card return">
        <mat-card-content>
          <div class="card-header">
            <div class="card-icon" aria-hidden="true">
              <mat-icon>trending_up</mat-icon>
            </div>
            <h3 class="card-label">Rentabilidade Acumulada</h3>
          </div>
          <div class="card-values">
            <p class="card-value" [class.positive]="summary.rentabilidadeAcumulada > 0" [class.negative]="summary.rentabilidadeAcumulada < 0">
              {{ summary.rentabilidadeAcumulada | currency:'BRL' }}
            </p>
            <p class="card-percentage" *ngIf="summary.valorTotalInvestido > 0">
              {{ (summary.rentabilidadeAcumulada / summary.valorTotalInvestido * 100).toFixed(2) | number:'1.2-2' }}% 
            </p>
          </div>
        </mat-card-content>
      </mat-card>

      <mat-card class="indicator-card total">
        <mat-card-content>
          <div class="card-header">
            <div class="card-icon" aria-hidden="true">
              <mat-icon>diamond</mat-icon>
            </div>
            <h3 class="card-label">Valor Atual Total</h3>
          </div>
          <p class="card-value">{{ summary.valorAtualTotal | currency:'BRL' }}</p>
        </mat-card-content>
      </mat-card>

      <mat-card class="indicator-card count">
        <mat-card-content>
          <div class="card-header">
            <div class="card-icon" aria-hidden="true">
              <mat-icon>bar_chart</mat-icon>
            </div>
            <h3 class="card-label">Investimentos Ativos</h3>
          </div>
          <p class="card-value">{{ summary.numeroInvestimentos }}</p>
        </mat-card-content>
      </mat-card>
    </section>

    <!-- Evolução dos Investimentos -->
    <section *ngIf="investments.length > 0" role="region" aria-labelledby="evolution-heading">
      <h2 id="evolution-heading" class="sr-only">Evolução dos Investimentos</h2>
      <app-investment-evolution-chart [investments]="investments"></app-investment-evolution-chart>
    </section>

    <!-- Distribuição por Tipo de Produto -->
    <section *ngIf="investments.length > 0" role="region" aria-labelledby="distribution-heading">
      <h2 id="distribution-heading" class="sr-only">Distribuição por Tipo de Produto</h2>
      <app-product-distribution-chart [investments]="investments"></app-product-distribution-chart>
    </section>

    <!-- Histórico do Perfil de Risco -->
    <section role="region" aria-labelledby="risk-history-heading">
      <h2 id="risk-history-heading" class="sr-only">Histórico do Perfil de Risco</h2>
      <app-risk-history-chart></app-risk-history-chart>
    </section>

    <!-- Lista de Investimentos -->
    <section *ngIf="investments.length > 0" role="region" aria-labelledby="investments-list-heading">
      <h2 id="investments-list-heading" class="sr-only">Lista de Investimentos</h2>
      <app-investments-list [investments]="investments"></app-investments-list>
    </section>

    <!-- Empty State -->
    <mat-card *ngIf="investments.length === 0" class="empty-state" role="status">
      <mat-card-content>
        <div class="empty-icon" aria-hidden="true">
          <mat-icon>work_outline</mat-icon>
        </div>
        <h2>Você ainda não possui investimentos</h2>
        <p>Comece agora explorando nossos produtos e simulando investimentos!</p>
        <nav class="empty-actions" aria-label="Ações rápidas">
          <a routerLink="/produtos" mat-raised-button color="primary" class="btn-primary">Ver Produtos</a>
          <a routerLink="/simulacao" mat-stroked-button color="primary" class="btn-secondary">Simular Investimento</a>
        </nav>
      </mat-card-content>
    </mat-card>

  </div>
</section>
