<mat-card class="investments-list-section">
  <mat-card-header>
    <mat-card-title class="section-title">
      <mat-icon>account_balance_wallet</mat-icon>
      Meus Investimentos
    </mat-card-title>
  </mat-card-header>
  
  <mat-card-content>
    <div *ngIf="investments.length === 0" class="empty-message">
      <mat-icon>inbox</mat-icon>
      <p>Nenhum investimento encontrado</p>
    </div>

    <div *ngIf="investments.length > 0" class="investments-grid">
      <mat-card *ngFor="let investment of displayedInvestments" class="investment-card">
        <!-- Card Header -->
        <mat-card-header class="card-header">
          <div class="product-info">
            <mat-card-title class="product-name">{{ investment.produto?.nome }}</mat-card-title>
            <mat-card-subtitle class="product-type">{{ investment.produto?.tipo }}</mat-card-subtitle>
          </div>
           <mat-chip [class]="'risk-' + getRiskClass(investment.produto?.risco || 'Médio')">{{
                  investment.produto?.risco
                }}</mat-chip>
         
        </mat-card-header>

        <!-- Card Body -->
        <mat-card-content class="card-body">
        <div class="info-row">
          <div class="info-item investido">
            <span class="info-label">Investido</span>
            <span class="info-value">{{ investment.valor | currency:'BRL' }}</span>
          </div>
          <div class="info-item valor-atual">
            <span class="info-label">Valor Atual</span>
            <span class="info-value">{{ investment.valorAtual | currency:'BRL' }}</span>
          </div>
        </div>

        <div class="info-row">
          <div class="info-item rentabilidade">
            <span class="info-label">Rentabilidade</span>
            <span class="info-value" [class.positive]="calculateReturn(investment) > 0" [class.negative]="calculateReturn(investment) < 0">
              {{ calculateReturn(investment) | currency:'BRL' }}
            </span>
          </div>
          <div class="info-item taxa-anual">
            <span class="info-label">Taxa Anual</span>
            <span class="info-value">{{ ((investment?.produto?.taxaAnual || 0) * 100).toFixed(2) }}% a.a.</span>
          </div>
        </div>

        <div class="info-row">
          <div class="info-item data-inicio">
            <span class="info-label">Data Início</span>
            <span class="info-value">{{ investment.dataInicio | date:'dd/MM/yyyy' }}</span>
          </div>
          <div class="info-item prazo">
            <span class="info-label">Prazo</span>
            <span class="info-value">{{ investment.prazoMeses }} meses ({{ getMonthsRemaining(investment) }} restantes)</span>
          </div>
        </div>

        </mat-card-content>


      </mat-card>
    </div>

    <!-- Ver Mais Button -->
    <div *ngIf="hasMore" class="show-more-container">
      <app-caixa-button
        [variant]="showAll ? 'outlined' : 'secondary'"
        [icon]="showAll ? 'expand_less' : 'expand_more'"
        (clicked)="toggleShowAll()">
        {{ showAll ? 'Ver Menos' : 'Ver Mais (' + (investments.length - displayLimit) + ' restantes)' }}
      </app-caixa-button>
    </div>
  </mat-card-content>
</mat-card>
